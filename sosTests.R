rm(list=ls())

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
print(getwd())

source("sos.R")


tf = butter(4 / 2, c(1.5, 23) / (1000 / 2))
z = roots(tf$b)
p = roots(tf$a)
k = tf$b[1] / tf$a[1]

zp2sos(z,p,k)
tf2sos(tf)


tf = butter(4, c(0.2, 0.6))
tf2sos(tf)
# [b, a] = butter(4, [0.2, 0.6]);
# [z,p,k] = tf2zp(b, a)
# [sos_var,g] = zp2sos(z, p, k)
# sos_var =
#     1.0000000   2.0001266   1.0001266   1.0000000   0.4575326   0.6245384
#     1.0000000   1.9998734   0.9998734   1.0000000  -0.0073608   0.1956041
#     1.0000000  -2.0000000   1.0000000   1.0000000  -0.8822287   0.3301957
#     1.0000000  -2.0000000   1.0000000   1.0000000  -1.3945409   0.7466724
# 
# g =  0.046583
#
# [z,p,g]=butter(4, [0.2, 0.6]);
# [sos_var,g] = zp2sos(z, p, k)
# sos_var =
#     1.0000000   2.0000000   1.0000000   1.0000000   0.4575326   0.6245384
#     1.0000000   2.0000000   1.0000000   1.0000000  -0.0073608   0.1956041
#     1.0000000  -2.0000000   1.0000000   1.0000000  -0.8822287   0.3301957
#     1.0000000  -2.0000000   1.0000000   1.0000000  -1.3945409   0.7466724
# g =  0.0041592




fs = 1000
tf2sos(butter(4 / 2, c(1.8, 30) / (fs/2)))
# [z,p,g]=butter(4/2, [1.8, 30]/(fs/2));
# [sos_var,g] = zp2sos(z, p, k)
# sos_var =
#     1.00000   2.00000   1.00000   1.00000  -1.76226   0.79070
#     1.00000  -2.00000   1.00000   1.00000  -1.98425   0.98439
# g =  0.0041592


tf = butter(4, 0.6, type = "low")
tf2sos(tf)
# [z,p,g]=butter(4, 0.6);
# [sos_var,g] = zp2sos(z, p, k)
# sos_var =
#     1.000000   2.000000   1.000000   1.000000   0.453120   0.466326
#     1.000000   2.000000   1.000000   1.000000   0.328976   0.064588
# g =  0.046583


tf = butter(4, 10 / (fs/2), type = "low")
tf2sos(tf)
# [z,p,g]=butter(4,  10 / (fs/2), type = "low");
# [sos_var,g] = zp2sos(z, p, k)

# { {1,2,1}, {1,-1.8866095826215084000,0.89033973628402607000}, 8.9848614639706479000e-007,  1  },
# { {1,2,1}, {1,-1.9492159580258410000,0.95306989532789022000}, 1, 1 }  }








